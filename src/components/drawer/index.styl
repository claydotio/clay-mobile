@require 'nib'

json('../../stylus/vars.json')
@require '../../stylus/utils.styl'

$drawerWidth = 288
$drawerContentPadding = 20
$drawerHeaderHeight = 50
$drawerNubRadius = 42.5
$zIndexDrawerPromoAfter = 0
$zIndexDrawerPromoText = 1
$zIndexDrawerHeader = 100

.drawer-overlay
  background: $overlayColor
  position: fixed
  width: 100%
  height: 100%
  display: none

  &.is-open
    display: block

.is-slow-device
  .drawer-overlay
    background: transparent // opaque background causes bad performance

.drawer-nub
  $drawerNubRadius = 42.5
  width: $drawerNubRadius px
  height: $drawerNubRadius px
  position: fixed
  top: 0
  right: 0
  -webkit-tap-highlight-color: $transparent
  pointer-events: all // not supported in ie9/10

.drawer
  width: ($drawerWidth + $drawerNubRadius) px
  right: -($drawerWidth)px
  height: 100%
  top: 0
  padding-left: $drawerNubRadius px
  position: fixed
  z-index: $zIndexDrawer
  transform: translateZ(0) /* gpu accelerate */
  transition: right 0.25s
  text-align: left
  pointer-events: none // not supported in ie9/10
  box-sizing: border-box

  &.is-open
    right: 0

.drawer-header
  width: 100%
  height: ($drawerHeaderHeight) px
  position: relative
  z-index: $zIndexDrawerHeader
  background: $orange
  pointer-events: all // not supported in ie9/10

  .drawer-close
    position: absolute
    left: 10px
    top: 13px

    > .icon-close
      font-size: $iconMedium
      color: $white


  .drawer-home
    position: absolute
    right: 10px
    top: 13px

    > .icon-home
      font-size: $iconMedium
      color: $white

.drawer-inner
  background: $bgColor
  height: 100%
  width: 100%
  // necessary for overflow: auto to work right since this is set to 100% height
  margin-top: -($drawerHeaderHeight) px
  padding-top: ($drawerHeaderHeight) px
  box-shadow: -10px 0 10px 0px rgba(0, 0, 0, 0.04)
  pointer-events: all // not supported in ie9/10
  overflow: auto
  box-sizing: border-box

.drawer-promo
  height: 92px
  position: relative
  background-size: 100% auto
  background-position: center

  &:after
    position: absolute
    z-index: $zIndexDrawerPromoAfter
    width: 100%
    height: 100%
    background: rgba(0, 0, 0, 0.5)
    content: ''

  > .drawer-promo-text
    position: absolute
    bottom: 0
    left: 20px
    right: 20px
    z-index: $zIndexDrawerPromoText
    color: $white

    > .drawer-promo-descriptor
        text-transform: uppercase
        font-size: $fontSizeSmall
        font-weight: bold
        margin-bottom: normalizeSpacing(5, unit($fontSizeSmall, '')) px

    > .drawer-promo-title
        margin: 0
        margin-top: normalizeSpacing(5, unit($fontSizeLarge, '')) px
        margin-bottom: normalizeSpacing(20, unit($fontSizeLarge, '')) px
        font-size: $fontSizeLarge
        whitespace: nowrap
        overflow: hidden
        text-overflow: ellipsis

.drawer-share
  text-align: center
  height: 80px
  width: 100%
  display: table
  background: $white

  > .drawer-share-inner
    display: table-cell
    vertical-align: middle
    padding: 0 20px

    .drawer-share-button

      > .icon-share
        margin-right: 10px

.drawer-marketplace-link
  display: block
  font-size: $fontSizeMedium
  font-weight: bold
  padding: ($drawerContentPadding)px

  &:active
    background: $activeBgColor

  > .icon-heart
    font-size: $iconMedium
    color: $orange
    margin-right: 10px


.drawer-cross-promotion
  padding: 0 ($drawerContentPadding)px 10px

.drawer-browse-more
  margin-top: 10px
  background: $white
  color: $blue


.is-android-2
  // links don't work
  .drawer-header
    position: static

    > .drawer-close
      position: static
      display: block
      padding: 10px

    > .drawer-home
      display: none

  .drawer-inner
    margin-top: 0
    padding-top: 0

  // bugs out touch events (overlay takes up whole page)
  .drawer-promo
    position: static

    &:after
      display: none

    > .drawer-promo-text
      position: static
      display: none

  .drawer-share-button
    display: none

  .drawer-browse-more
    display: none
